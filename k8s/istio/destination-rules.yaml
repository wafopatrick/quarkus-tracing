apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: kafka
  namespace: data
spec:
  host: kafka.data.svc.cluster.local
  trafficPolicy:
    tls:
      mode: DISABLE  # Apps use plaintext to connect to Kafka (via Istio)
---
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: services
  namespace: apps
spec:
  host: "*.apps.svc.cluster.local"
  trafficPolicy:
    tls:
      mode: ISTIO_MUTUAL
